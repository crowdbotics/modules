{
  "articles": {
    "backend/modules/articles/README.md": {
      "code": "## Crowdbotics Articles Component - Backend\n\nThis module contains all needed resources to get the Articles component for React\nNative mobile client.\n\n- This module uses media files (Images for articles). You should enable S3 support\n  in your Crowdbotics app in order to get it working properly.\n- `Pillow` version `8.1.0` or higher is required, check your version on the `backend/Pipfile`. If you need to install or upgrade `Pillow` visit https://pillow.readthedocs.io/ and check how to do this.\n",
      "parentDir": "/",
      "newFile": true
    },
    "backend/modules/articles/__init__.py": {
      "code": "",
      "parentDir": "/",
      "newFile": true
    },
    "backend/modules/articles/admin.py": {
      "code": "from django.contrib import admin\nfrom .models import Article\n\nadmin.site.register(Article)\n",
      "parentDir": "/",
      "newFile": true
    },
    "backend/modules/articles/models.py": {
      "code": "from django.conf import settings\nfrom django.db import models\n\n\nclass Article(models.Model):\n    \"Generated Model\"\n    title = models.CharField(\n        max_length=256,\n    )\n    body = models.TextField()\n    author = models.ForeignKey(\n        settings.AUTH_USER_MODEL,\n        on_delete=models.PROTECT,\n        related_name=\"article_author\",\n    )\n    image = models.ImageField(upload_to=\"mediafiles/articles/\", blank=True, null=True)\n    created_at = models.DateTimeField(\n        auto_now_add=True,\n    )\n    updated_at = models.DateTimeField(\n        auto_now=True,\n    )\n",
      "parentDir": "/",
      "newFile": true
    },
    "backend/modules/articles/serializers.py": {
      "code": "from rest_framework import serializers\nfrom .models import Article\nimport base64\nimport imghdr\nimport io\nimport secrets\nfrom django.core.files.base import ContentFile\nfrom PIL import Image\n\n\nclass Base64ImageField(serializers.ImageField):\n    \"\"\"\n    A Django REST framework field for handling image-uploads through raw post data.\n    It uses base64 for encoding and decoding the contents of the file.\n    \"\"\"\n\n    def to_internal_value(self, data):\n        # Check if this is a base64 string\n        if isinstance(data, str):\n            # Check if the base64 string is in the \"data:\" format\n            if \"data:\" in data and \";base64,\" in data:\n                # Break out the header from the base64 content\n                header, data = data.split(\";base64,\")\n                # Try to decode the file. Return validation error if it fails.\n                try:\n                    decoded_file = base64.b64decode(data)\n                except TypeError:\n                    self.fail(\"invalid_image\")\n\n                # Generate file name:\n                file_name = secrets.token_urlsafe(\n                    12\n                )  # 12 characters are more than enough.\n                # Get the file name extension:\n                file_extension = self.get_file_extension(file_name, decoded_file)\n                complete_file_name = \"{0}.{1}\".format(file_name, file_extension)\n                data = ContentFile(decoded_file, name=complete_file_name)\n\n        return super().to_internal_value(data)\n\n    @staticmethod\n    def get_file_extension(file_name, decoded_file):\n        extension = imghdr.what(file_name, decoded_file)\n        if extension is None:\n            image = Image.open(io.BytesIO(decoded_file))\n            extension = image.format.lower()\n        extension = \"jpg\" if extension == \"jpeg\" else extension\n        return extension\n\n\nclass ArticleSerializer(serializers.ModelSerializer):\n    image = Base64ImageField(max_length=None, required=False)\n\n    class Meta:\n        model = Article\n        fields = [\n            \"id\",\n            \"title\",\n            \"body\",\n            \"author\",\n            \"image\",\n            \"created_at\",\n            \"updated_at\",\n        ]\n        read_only_fields = [\"id\"]\n",
      "parentDir": "/",
      "newFile": true
    },
    "backend/modules/articles/urls.py": {
      "code": "from django.urls import path, include\nfrom rest_framework.routers import DefaultRouter\nfrom .viewsets import ArticleViewSet\n\nrouter = DefaultRouter()\nrouter.register(\"article\", ArticleViewSet)\n\nurlpatterns = [\n    path(\"\", include(router.urls)),\n]\n",
      "parentDir": "/",
      "newFile": true
    },
    "backend/modules/articles/viewsets.py": {
      "code": "from rest_framework import authentication, permissions\nfrom .models import Article\nfrom .serializers import ArticleSerializer\nfrom rest_framework import viewsets\n\n\nclass ArticleViewSet(viewsets.ModelViewSet):\n    serializer_class = ArticleSerializer\n    permission_classes = [permissions.AllowAny]\n    authentication_classes = (\n        authentication.SessionAuthentication,\n        authentication.TokenAuthentication,\n    )\n    queryset = Article.objects.all()\n",
      "parentDir": "/",
      "newFile": true
    },
    "backend/modules/migrations/0001_articles_initial.py": {
      "code": "# Generated by Django 2.2.17 on 2020-12-18 19:57\n\nfrom django.conf import settings\nfrom django.db import migrations, models\nimport django.db.models.deletion\n\n\nclass Migration(migrations.Migration):\n\n    initial = True\n\n    dependencies = [\n        migrations.swappable_dependency(settings.AUTH_USER_MODEL),\n    ]\n\n    operations = [\n        migrations.CreateModel(\n            name=\"Article\",\n            fields=[\n                (\n                    \"id\",\n                    models.AutoField(\n                        auto_created=True,\n                        primary_key=True,\n                        serialize=False,\n                        verbose_name=\"ID\",\n                    ),\n                ),\n                (\"title\", models.CharField(max_length=256)),\n                (\"body\", models.TextField()),\n                (\"created_at\", models.DateTimeField(auto_now_add=True)),\n                (\n                    \"image\",\n                    models.ImageField(\n                        upload_to=\"mediafiles/articles/\", blank=True, null=True\n                    ),\n                ),\n                (\"updated_at\", models.DateTimeField(auto_now=True)),\n                (\n                    \"author\",\n                    models.ForeignKey(\n                        on_delete=django.db.models.deletion.PROTECT,\n                        related_name=\"article_author\",\n                        to=settings.AUTH_USER_MODEL,\n                    ),\n                ),\n            ],\n        ),\n    ]\n",
      "parentDir": "/",
      "newFile": true
    }
  },
  "social-auth": {
    "backend/modules/social-auth/README.md": {
      "code": "# Crowdbotics Social Login Module - Backend\nThis module contains all needed resources and information to setup Social Login in your app backend.\n\n## Extra installation steps\nAfter adding this module to your project, you need to include the facebook authentication third party app in your `settings.py` file. To do that, open your project's settings.py file - it should be in the path `/<your_repo_name>/backend/<your_repo_name>/settings.py`, where <your_repo_name> is the name of your project's repository. For example, if my repository name is `social_login_1234`, my file should be located at `social_login_1234/backend/social_login_1234/settings.py`.\n\nOnce the file is opened, locate in the code a declaration for `THIRD_PARTY_APPS` and include `'allauth.socialaccount.providers.facebook',` and `'allauth.socialaccount.providers.apple',` at the end. Your app should ght already have `'allauth.socialaccount.providers.google'` added there, so you should verify; but if it is not there, then add it as well. Your code section should look roughly like this:\n\n```py\nTHIRD_PARTY_APPS = [\n    'rest_framework',\n    'rest_framework.authtoken',\n    'rest_auth',\n    'rest_auth.registration',\n    'allauth.socialaccount.providers.google',\n\n    # More apps added before here...\n\n    'allauth.socialaccount.providers.facebook', # add this line here\n    'allauth.socialaccount.providers.apple', # add this other line\n]\n```\n\nYou should now deploy your app's backend in order to proceed to the next step.\n\n## Configuring Facebook\nYou need to setup Facebook SDK to get social login properly configured in your app. Ideally, these steps should be done by the project owner or with an project owner account, as it needs to be properly configured for app store release, but it can be done with development configurion during development phase. \n\n1. First, access Facebook for developers at https://developers.facebook.com and register for a developer account, if you do not already have one.\n\n2. After that, access the [your facebook apps page](https://developers.facebook.com/apps/) and choose to create a Facebook app. FOr the purpose of social login, you could choose the `build connected experiences` upon facing the question \"What do you need your app to do?\" and click continue (as shown below). In the next page, type in the name of your app, contact email and, if existing, business manager account for the app and click `Create App`:\n\n![facebook-create-app](https://crowdbotics-slack-dev.s3.amazonaws.com/media/resources/project/18906/15c9063c-6f5d-4afa-a77f-76f75c15e062.png)\n![](https://crowdbotics-slack-dev.s3.amazonaws.com/media/resources/project/18906/ff97ef37-8535-4f4b-958f-def310bf110d.png)\n\n3. After creation, go to your Facebook app's dashboard and look for an option to set up social login product to your app. The url should look like this: `https://developers.facebook.com/apps/<your_facebook_app_id>/fb-login/quickstart/`. There, choose the web option (to register a key to your backend).\n\n4. Then, you will be prompted to add your website url (point 1 in the image below) and save (point 2) - your website url is where your backend is being served - you can find this url by clicking on `View App` at crowdbotics dashboard `Settings` page. Check out our knowledge base for more information.\n\n5. After saving, navigate to Facebook dashboard at `Settings -> Basic` (as shown in point 3 of image below).\n![](https://crowdbotics-slack-dev.s3.amazonaws.com/media/resources/project/18906/596578e6-d64c-4d04-a4fa-712da80aa1f5.png)\n\nYou need to keep this page open and navigate to another browser tab, as you will need to copy both `App ID` and `App Secret` to paste on your own project admin page. \n\n6. Navigate to Crowdbotics dashboard for your app and access your app's admin panel. If you do not know what does this mean, please, check out our [Knowledge Base Article](https://knowledge.crowdbotics.com/what-is-the-admin-panel).\n\nAt your app's admin page, try to find `Social Accounts` section and click on `Social Applications`: \n![](https://crowdbotics-slack-dev.s3.amazonaws.com/media/resources/project/18906/9babfe52-423f-40dc-afa0-a5d038782640.png)\n\n7. Then, click to `Add a social Application +` on the button at the right side of your screen. Fill out the form as follows and save:\n\n- Provider: Facebook\n- Name: Facebook (or any name you would like to give that helps you identify this facebook configuration)\n- Client id: Your `App ID` from facebook settings\n- Secret Key: The `App Secret` from facebook settings\n- Sites: your website url, just move it to the right panel. \n\nIt should end up as something like this:\n\n![](https://crowdbotics-slack-dev.s3.amazonaws.com/media/resources/project/18906/fc889f58-78a5-4828-abb2-4285acac560e.png)\n\nYour backend is now ready to accept facebook login. Redeploy your application so all changes are applied to the server.\n\n## Configuring Google\nSimilarly to Facebook, Google login should ideally be configured in the Google account that is going to manage everything related to this project (usually, the project owner). But for development purposes, it can temporarily be configured by anyone.\n\n1. Configure your Google Cloud account to access the [console](https://console.developers.google.com/), and to start a quick setup of an API project, visit https://developers.google.com/identity/sign-in/android/start#configure-a-google-api-project and click on `Configure a Project`. \n2. There, you will choose to create a new project (or your an existing one, if desired). Follow the instructions, filling out product name, choosing `Web Server` as your OAuth client and pasting your app's url as the Authorized redirect URIs and your app's url appended with `/accounts/google/login/callback/`.\nFor example, this tutorial app link is `https://social-login-1234.botics.co/` so you should provide both `https://social-login-1234.botics.co/` and `https://social-login-1234.botics.co/accounts/google/login/callback/`.\nFinish up and `Download Client Configuration` (you will need this information later).\n\n3. Navigate to Crowdbotics dashboard for your app and access your app's admin panel to add the Google API information. To do so, follow steps 6 and 7 from the Facebook configuration above, and input the form values as follows:\n\n- Provider: Google\n- Name: Google (or any name you would like to give that helps you identify this google configuration)\n- Client id: Your `Client ID` (`client_id`) from Google's credentials configuration\n- Secret Key: The `Client Secret` (`client_secret`) Google's credentials configuration\n- Sites: your website url, just move it to the right panel. \n\n## Configuring Apple\nSimilarly to Facebook, Apple login should ideally be configured in the Google account that is going to manage everything related to this project (usually, the project owner). But for development purposes, it can temporarily be configured by anyone.\n\nTODO",
      "parentDir": "/",
      "newFile": true
    },
    "backend/modules/social-auth/__init__.py": {
      "code": "",
      "parentDir": "/",
      "newFile": true
    },
    "backend/modules/social-auth/urls.py": {
      "code": "from django.urls import path, include\nfrom .views import FacebookConnect, GoogleConnect\nfrom rest_auth.registration.views import (\n    SocialAccountListView,\n    SocialAccountDisconnectView,\n)\n\nurlpatterns = [\n    path('facebook/connect/', FacebookConnect.as_view(), name='social_facebook_connect'),\n    path('google/connect/', GoogleConnect.as_view(), name='social_google_connect'),\n    # List all connected social accounts -> Developer can use to get pk for disconnecting\n    path(\n        \"socialaccounts/\", SocialAccountListView.as_view(), name=\"social_account_list\"\n    ), \n    # Allows to disconnect social account\n    path(\n        \"socialaccounts/<int:pk>/disconnect/\",\n        SocialAccountDisconnectView.as_view(),\n        name=\"social_account_disconnect\",\n    ),\n]\n",
      "parentDir": "/",
      "newFile": true
    },
    "backend/modules/social-auth/views.py": {
      "code": "from rest_auth.registration.views import SocialLoginView\nfrom rest_framework.permissions import AllowAny\nfrom allauth.socialaccount.providers.facebook.views import FacebookOAuth2Adapter\nfrom allauth.socialaccount.providers.google.views import GoogleOAuth2Adapter\nfrom allauth.socialaccount.providers.oauth2.client import OAuth2Client\n\n\nclass FacebookConnect(SocialLoginView):\n    permission_classes = (AllowAny,)\n    adapter_class = FacebookOAuth2Adapter\n\nclass GoogleConnect(SocialLoginView):\n    permission_classes = (AllowAny,)\n    adapter_class = GoogleOAuth2Adapter\n    client_class = OAuth2Client\n",
      "parentDir": "/",
      "newFile": true
    }
  }
}